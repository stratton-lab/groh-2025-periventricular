%% Load variables for ependyma-in gradient analysis 
MSslabs = ["03_1011_Frontal_MS", "01_1011_Caudal_MS",...
    "05_1002_Frontal_WithVentricle_MS", "06_1002_Middle_MS", "07_1002_Caudal_MS",...
    "08_1090_Frontal_MS", "09_1090_Middle_MS", "10_1090_Caudal_Large_MS",...
    "26_1736_Frontal_Large_MS","27_1736_Middle_MS","28_1736_Caudal_MS"];
patholDataMS = {[5 7 20 1],...
    [11 2 14 1; 12 2 10 1],...
    [2 2 15 1; 3 2 19 1; 4 4 19 1; 5 5 19 1; 11	2 13 1; 12 2 11 1; 20 2	5 1],...
    [6 2 19 1; 7 2 22 1; 8 2 25 1; 9 2 25 1],...
    [1 2 24 1; 2 2 24 1; 3 2 24 1; 4 2 11 1; 5 2 7 1; 6	4 12 1;...
    7 4	16 1; 8	3 8 1; 9 3 6 1; 10 2 6 1; 11 2 9 1; 12 2 8 1],...
    [3 4 13 1; 4 10	18 1; 11 2 4 1; 12 2 4 1],...
    [7 2 5 1; 8	2 6 1; 9 2 6 1; 10 2 6 1; 11 3 7 1],...
    [4 2 4 1; 5 2 4 1; 6 2 3 1],...
    [1 2 13 1; 2 2 14 1; 3 2 14 1; 4 2 14 1;...
    5 2	13 1; 6	2 18 1; 7 2	18 1; 8	2 4 1;...
    9 2	4 1; 10	2 4 1; 11 2	4 1; 12	2 7 1;...
    13 2 8 1; 24 4 10 1],...
    [8 9 23 1; 9 9 20 1],...
    [1 3 22 1; 2 3 21 1; 3 3 21 1; 5 4 21 1;...
    8 4	10 1; 9	3 7 1; 10 2	8 1; 11	2 7 1]}; 
    
HCslabs = ["12_1143_Frontal_Cl", "13_1143_Middle_Cl", "14_1143_Caudal_Cl",...
    "20_1670_Middle_Cl", "21_1670_Caudal_Cl", "22_1722_Frontal_Cl",...
    "24_1722_Caudal_Cl", "32_989_Frontal_Cl","33_989_Caudal_Cl"];
patholDataHC = {[1 5 20 1; 4 7 17 1; 6 11 19 1; 8 11 19 1; 9 8 15 1; 24	6 24 1],...
    [7 15 26 1; 10 16 36 1; 11 23 36 1],...
    [1 15 36 1; 2 11 36 1; 3 11	31 1; 4	10 28 1;...
    7 5	17 1; 8	6 16 1; 10 5 15 1; 11 2	17 1],...
    [2 9 19 1; 3 10	20 1; 5	10 26 1; 6 9 26 1],...
    [2 10 27 1; 3 10 25 1; 4 10	25 1; 5	6 26 1;...
    6 6	24 1; 7	5 21 1; 8 5	18 1; 9	5 15 1;...
    10 5 14 1; 11 2	14 1; 12 2 13 1; 13	2 8 1],...
    [2 2 20 1; 3 2 16 1; 4 2 13 1; 5 2 18 1;...
    6 2	18 1; 7	2 19 1; 8 2	17 1; 9	2 13 1;...
    10 2 13 1; 11 2	12 1; 12 2 12 1; 13	2 12 1],...
    [1 6 25 1; 2 5 21 1; 6 4 16 1;...
    13 5 11 1; 23 6	28 1; 24 6 26 1],...
    [1 2 19 1; 2 2 15 1; 3 2 13 1; 4 2 9 1; 12 2 11 1],...
    [1 2 26 1; 2 4 21 1; 3 4 22 1; 4 4 22 1;...
    9 3	12 1; 10 3 11 1]}; 

%% 
noSlabs = length(MSslabs); 
T1maxdf_MS = cell(1, noSlabs); T2strmaxdf_MS = T1maxdf_MS;
T1del_MS = T1maxdf_MS; T2stardel_MS = T1maxdf_MS; 
for s = 1:noSlabs 
    [~, T1maxdf_MS{s}, T2strmaxdf_MS{s}, T1del_MS{s}, T2stardel_MS{s}] =...
        maxRateOfChange(MSslabs(s),patholDataMS{s},1.5);
end 

noSlabs = length(HCslabs); 
T1maxdf_HC = cell(1, noSlabs); T2strmaxdf_HC = T1maxdf_HC;
T1del_HC = T1maxdf_HC; T2stardel_HC = T1maxdf_HC; 
for s = 1:noSlabs 
    [~, T1maxdf_HC{s}, T2strmaxdf_HC{s}, T1del_HC{s}, T2stardel_HC{s}] =...
        maxRateOfChange(HCslabs(s),patholDataHC{s},1.5);
end 

save("t1_t2star_grad.mat", "T1maxdf_HC", "T1maxdf_MS", "T1del_HC", "T1del_MS",...
    "T2strmaxdf_HC", "T2strmaxdf_MS", "T2stardel_HC", "T2stardel_MS"); %, "relLat*", "latVent*"); 

%% Load variables for pia-in gradient analysis 
MSslabs = ["01_1011_Caudal_MS", "03_1011_Frontal_MS",...
    "05_1002_Frontal_WithVentricle_MS", "06_1002_Middle_MS", "07_1002_Caudal_MS",...
    "08_1090_Frontal_MS", "09_1090_Middle_MS", "10_1090_Caudal_Large_MS",...
    "16_1421_Frontal_Large_MS", "18_1421_Caudal_MS",...
    "26_1736_Frontal_Large_MS","27_1736_Middle_MS"];

HCslabs = ["12_1143_Frontal_Cl", "13_1143_Middle_Cl", "14_1143_Caudal_Cl",...
    "19_1670_Frontal_Cl","20_1670_Middle_Cl", "21_1670_Caudal_Cl", "22_1722_Frontal_Cl",...
    "23_1722_Middle_Cl", "24_1722_Caudal_Cl", "32_989_Frontal_Cl","33_989_Caudal_Cl"];
